import{r as e,a as t}from"./vendor.de62f314.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const r=new URL(e,location),a=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,o)=>{const l=new URL(e,r);if(self[t].moduleMap[l])return n(self[t].moduleMap[l]);const i=new Blob([`import * as m from '${l}';`,`${t}.moduleMap['${l}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){o(new Error(`Failed to import: ${e}`)),a(c)},onload(){n(self[t].moduleMap[l]),a(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("/depix/assets/");function n(e){const[t,n]=function(e){const t=new Map;let n=0;for(let r=0;r<e.length;r++){const a=e[r],o=(t.get(a)||0)+1;t.set(a,o),n=o>n?o:n}return[t,n]}(e);for(const[r,a]of t)if(a===n)return[r,a];return[void 0,0]}function r(){const[t,r]=e.useState(),[a,o]=e.useState(1),l=e.useRef(null),i=e.useRef(null),c=e.useCallback((e=>{var t;const n=null==(t=e.target.files)?void 0:t[0];n&&function(e){return new Promise(((t,n)=>{const r=new FileReader;r.addEventListener("load",(a=>{const o=r.result;if(!o)return n("no file result");const l=new Image;l.addEventListener("load",(n=>{t({file:e,image:l})})),l.addEventListener("error",n),l.src=o.toString()})),r.addEventListener("error",n),r.readAsDataURL(e)}))}(n).then(r)}),[]);return e.useEffect((()=>{const e=l.current;if(!t||!e)return;const r=e.width=t.image.width,a=e.height=t.image.height,i=e.getContext("2d");if(!i)return;i.fillStyle="white",i.fillRect(0,0,r,a),i.drawImage(t.image,0,0);const c=function(e){const t=4*e.width,n=[];let r=0;for(let a=1;a<e.height;a++){const o=(a-1)*t,l=a*t,i=(a+1)*t,c=e.data.subarray(o,l-1);e.data.subarray(l,i-1).every(((e,t)=>e===c[t]))||(n.push([r,a]),r=a)}return n}(i.getImageData(0,0,r,a));c.forEach((([e,t],n)=>{i.fillStyle="red",i.fillRect(r/2+n%2*5,e,2,t-e)}));const s=c.map((([e,t])=>t-e)),[m]=n(s);m&&o(m)}),[l.current,t]),e.useEffect((()=>{const e=i.current;if(!t||!e)return;const n=e.width=t.image.width/a,r=e.height=t.image.height/a,o=e.getContext("2d");o&&(o.imageSmoothingEnabled=!1,o.drawImage(t.image,0,0,n,r))}),[i.current,t,a]),e.createElement("div",{id:"container"},e.createElement("div",null,e.createElement("div",{className:"help"},"This app detects the scale factor of an upscaled pixel art image and scales it down for you. You can right-click the result image to save or copy it.",e.createElement("br",null),"Implementation: ",e.createElement("a",{href:"https://twitter.com/akx"},"@akx"),", algorithm:"," ",e.createElement("a",{href:"https://twitter.com/ochrons"},"@ochrons")),e.createElement("label",null,"Pick a pixel art image: ",e.createElement("input",{type:"file",accept:"image/*",onChange:c}))),e.createElement("div",null,"Scale factor guess: ",a,"×"),e.createElement("canvas",{ref:l}),e.createElement("canvas",{ref:i,style:{imageRendering:"pixelated"}}))}t.render(e.createElement(e.StrictMode,null,e.createElement(r,null)),document.getElementById("root"));
